<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> From Noise to Masterpiece: Demystifying Diffusion Models, The Art of AI Creation | Adarsh Nair </title> <meta name="author" content="Adarsh Nair"> <meta name="description" content="A deep dive into machine learning, AI, and data science. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; media-src 'self' https:; frame-src 'self' https:; connect-src 'self' https:;"> <link rel="stylesheet" href="/blog/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/blog/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/blog/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/blog/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/blog/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://adarshnair.online/blog/blog/blog/2024/from-noise-to-masterpiece-demystifying-diffusion-m/"> <script src="/blog/assets/js/theme.js?v=5fea5159b787642c1bbc1f334d60f883"></script> <link defer rel="stylesheet" href="/blog/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://adarshnair.online" rel="external nofollow noopener" target="_blank"> Adarsh Nair </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/blog/"> </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/index.html">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/repositories/">repositories </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">From Noise to Masterpiece: Demystifying Diffusion Models, The Art of AI Creation</h1> <p class="post-meta"> Created on April 03, 2024 by Adarsh Nair </p> <p class="post-tags"> <a href="/blog/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/blog/tag/diffusion-models"> <i class="fa-solid fa-hashtag fa-sm"></i> Diffusion Models</a>   <a href="/blog/blog/tag/generative-ai"> <i class="fa-solid fa-hashtag fa-sm"></i> Generative AI</a>   <a href="/blog/blog/tag/machine-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> Machine Learning</a>   <a href="/blog/blog/tag/deep-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> Deep Learning</a>   <a href="/blog/blog/tag/image-generation"> <i class="fa-solid fa-hashtag fa-sm"></i> Image Generation</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>As a budding data scientist and machine learning engineer, few things excite me as much as algorithms that can <em>create</em>. For years, Generative Adversarial Networks (GANs) held the crown for generating incredibly realistic images, but they often came with a notorious reputation for tricky training and mode collapse. Then, a new contender emerged from the shadows, quietly and steadily, to redefine what’s possible: <strong>Diffusion Models</strong>.</p> <p>If you’ve marvelled at the breathtaking imagery from tools like DALL-E, Midjourney, or Stable Diffusion, you’ve witnessed the power of Diffusion Models in action. They don’t just mimic; they genuinely <em>synthesize</em> new data that often feels indistinguishable from reality, or even transcends it into realms of pure imagination. In this post, I want to take you on a journey to understand the elegant simplicity and profound power behind these models, from their core mathematical ideas to their jaw-dropping applications.</p> <h3 id="the-spark-of-creation-an-intuitive-beginning">The Spark of Creation: An Intuitive Beginning</h3> <p>Let’s start with an analogy. Imagine you have a beautiful, clear photograph. Now, imagine someone slowly, step by step, adding tiny, random specks of dust, smudges, and blur until the original image is completely obscured, turning into pure, indecipherable static.</p> <p>This sounds like destruction, right? But what if you could <em>reverse</em> that process? What if you had a magical tool that could look at the noisy, smudged mess and, with incredible precision, remove just the right amount of noise at each step, slowly revealing the original photograph underneath? That’s the essence of Diffusion Models.</p> <p>They learn to reverse this “noising-up” process. Instead of starting with a clear image and destroying it, they start with pure random noise and learn to <em>refine</em> it, step by step, into something meaningful – a photorealistic face, a vibrant landscape, or a fantastical creature.</p> <h3 id="part-1-the-forward-diffusion-process--embracing-the-noise">Part 1: The Forward Diffusion Process – Embracing the Noise</h3> <p>The first half of the diffusion journey is straightforward and entirely deterministic. It’s the “noising-up” part. We take an original data point (let’s say an image, $x_0$) and progressively add Gaussian noise to it over a series of $T$ timesteps.</p> <p>Think of $x_0$ as your pristine photo. At each timestep $t$ (from 1 to $T$), we add a little more noise, gradually transforming $x_0$ into $x_1, x_2, \ldots, x_T$. By the time we reach $x_T$, our original image is completely drowned in noise, becoming something that looks like pure static.</p> <p>The beauty of this forward process is that we know exactly how much noise we add at each step. It’s defined by a <strong>variance schedule</strong>, $\beta_1, \beta_2, \ldots, \beta_T$, which dictates the amount of noise added at each step. A common way to model this is:</p> \[x*t = \sqrt{1 - \beta_t} x*{t-1} + \sqrt{\beta_t} \epsilon\] <p>Here:</p> <ul> <li>$x_t$ is the image at timestep $t$.</li> <li>$x_{t-1}$ is the image from the previous timestep.</li> <li>$\beta_t$ is a small, increasing value that controls the noise level (e.g., from 0.0001 to 0.02).</li> <li>$\epsilon$ is a random sample from a standard Gaussian distribution ($\mathcal{N}(0, 1)$), representing the new noise we add.</li> </ul> <p>This equation essentially says: “Take a little bit of the previous image, add a little bit of new random noise.” As $t$ increases, $\beta_t$ increases, meaning we add more noise, eventually leading to $x_T$ being pure noise.</p> <p>A particularly elegant property of this process is that we can directly sample $x_t$ from $x_0$ at <em>any</em> timestep $t$ without needing to go through all the intermediate steps. This is thanks to the reparameterization trick and the properties of Gaussian distributions:</p> \[x_t = \sqrt{\bar{\alpha}\_t} x_0 + \sqrt{1 - \bar{\alpha}\_t} \epsilon\] <p>where $\alpha_t = 1 - \beta_t$ and $\bar{\alpha}<em>t = \prod</em>{s=1}^t \alpha_s$. This means we can grab any image $x_0$, pick a random timestep $t$, and instantly get a noisy version $x_t$ just by knowing $x_0$ and the noise $\epsilon$ that corrupted it. This becomes incredibly useful for training.</p> <h3 id="part-2-the-reverse-diffusion-process--learning-to-create">Part 2: The Reverse Diffusion Process – Learning to Create</h3> <p>This is where the true magic, and the machine learning, happens. Our goal is to reverse the forward process. That means, given a noisy image $x_t$, we want to predict the <em>less noisy</em> image $x_{t-1}$. If we can do this repeatedly, starting from pure noise $x_T$, we can eventually generate a clean image $x_0$.</p> <p>The problem? While the forward process has a simple, known distribution (it’s a Gaussian), the reverse process is complex and intractable. We can’t just apply a simple formula to “un-noise” the image. This is where our neural network comes in.</p> <table> <tbody> <tr> <td>We train a deep learning model, typically a <strong>U-Net</strong> architecture (known for its effectiveness in image-to-image tasks), to learn the reverse transitions. What exactly does this U-Net predict? It turns out that if the $\beta_t$ values are small, the reverse process is also approximately Gaussian. This means we can approximate the mean and variance of $q(x_{t-1}</td> <td>x_t)$.</td> </tr> </tbody> </table> <p>Crucially, it can be shown that if we can predict the noise $\epsilon$ that was added to $x_0$ to get $x_t$ (i.e., the $\epsilon$ in the direct sampling equation for $x_t$), we can then derive $x_{t-1}$. So, our U-Net, let’s call it $\epsilon_\theta$, is trained to predict this noise $\epsilon$ given a noisy image $x_t$ and the current timestep $t$.</p> \[\text{Our model predicts: } \epsilon\_\theta(x_t, t) \approx \epsilon\] <p><strong>How do we train it?</strong></p> <ol> <li>Take a random clean image $x_0$ from our dataset.</li> <li>Sample a random timestep $t$ between 1 and $T$.</li> <li>Generate a noisy image $x_t$ by directly applying the forward diffusion equation using a random noise $\epsilon$ ($x_t = \sqrt{\bar{\alpha}_t} x_0 + \sqrt{1 - \bar{\alpha}_t} \epsilon$).</li> <li>Feed $x_t$ and $t$ into our U-Net model $\epsilon_\theta(x_t, t)$.</li> <li>The model outputs its <em>prediction</em> for the noise.</li> <li>We compare this predicted noise with the <em>actual</em> noise $\epsilon$ we used to create $x_t$.</li> <li>We then update the U-Net’s weights using a simple mean squared error loss function:</li> </ol> \[L*t = ||\epsilon - \epsilon*\theta(x_t, t)||^2\] <p>This is incredibly powerful! We’re essentially teaching the model to identify and remove the <em>exact</em> noise that was added at any given stage of the degradation process.</p> <p><strong>Generating new data (Sampling):</strong> Once our model is trained, generating a new image is like playing the movie in reverse:</p> <ol> <li>Start with pure random Gaussian noise, $x_T$.</li> <li>For $t$ from $T$ down to 1: <ul> <li>Use the trained U-Net $\epsilon_\theta(x_t, t)$ to predict the noise component in $x_t$.</li> <li>Subtract this predicted noise to get a slightly less noisy image, $x_{t-1}$.</li> <li>This step involves a bit more math to properly combine the predicted noise with the variance schedule to get $x_{t-1}$. The general form looks something like this: \(x*{t-1} = \frac{1}{\sqrt{\alpha_t}} \left( x_t - \frac{1 - \alpha_t}{\sqrt{1 - \bar{\alpha}\_t}} \epsilon*\theta(x_t, t) \right) + \sigma_t z\) where $z \sim \mathcal{N}(0, 1)$ adds a bit of controlled random noise back, and $\sigma_t$ is the variance of the reverse process (often $\beta_t$). This ensures diversity in generation.</li> </ul> </li> <li>Repeat until $x_0$ is generated – a completely new, clean image!</li> </ol> <h3 id="why-are-diffusion-models-so-good">Why Are Diffusion Models So Good?</h3> <ol> <li> <strong>Stable Training:</strong> Unlike GANs, which involve an adversarial dance between two networks, Diffusion Models train with a straightforward optimization objective (minimizing MSE on noise prediction). This makes them much more stable and easier to train.</li> <li> <strong>High Quality &amp; Diversity:</strong> The iterative denoising process allows for incredibly fine-grained control and leads to remarkably high-fidelity samples. Each step refines the image, building complexity layer by layer. The controlled randomness at each reverse step also ensures a wide diversity of generated outputs.</li> <li> <strong>Scalability &amp; Parallelism:</strong> The forward process and the noise prediction loss can be computed for any $t$ independently, making training highly parallelizable across different timesteps.</li> <li> <strong>Flexibility:</strong> Diffusion Models are incredibly versatile. You can <strong>condition</strong> them on text descriptions (like “a cat riding a skateboard”), on other images (for inpainting or outpainting), or even on other modalities. This is usually done by incorporating the conditioning information (e.g., text embedding) into the U-Net.</li> </ol> <h3 id="key-components-under-the-hood">Key Components Under the Hood</h3> <ul> <li> <strong>U-Net Architecture:</strong> This robust convolutional network structure is crucial. It efficiently captures both local and global features of the image, making it excellent at understanding context and predicting noise across different scales. Its skip connections are key to preserving fine-grained details.</li> <li> <strong>Timestep Embeddings:</strong> Since the amount of noise varies with $t$, the U-Net needs to know which timestep it’s operating on. This is usually done by encoding the timestep $t$ into a high-dimensional vector (similar to positional encodings in Transformers) and feeding it to the network at various layers.</li> <li> <strong>Latent Diffusion:</strong> For very high-resolution images, running the diffusion process directly on pixels can be computationally expensive. Models like Stable Diffusion address this by first training an autoencoder to compress images into a lower-dimensional “latent space.” The diffusion process then happens entirely within this more efficient latent space, and the autoencoder’s decoder then reconstructs the final high-resolution image from the generated latent representation. This is a game-changer for speed and resource efficiency.</li> </ul> <h3 id="beyond-images-the-diffusion-revolution">Beyond Images: The Diffusion Revolution</h3> <p>While images are their most famous domain, Diffusion Models are rapidly expanding:</p> <ul> <li> <strong>Video Generation:</strong> Generating coherent sequences of frames.</li> <li> <strong>Audio Synthesis:</strong> Creating realistic speech, music, or sound effects.</li> <li> <strong>3D Object Generation:</strong> Crafting novel 3D models.</li> <li> <strong>Drug Discovery:</strong> Generating new molecular structures with desired properties.</li> <li> <strong>Text Generation:</strong> Though less common than images, early research shows promise.</li> </ul> <h3 id="conclusion-sculpting-reality-from-randomness">Conclusion: Sculpting Reality from Randomness</h3> <p>The journey from pure, meaningless noise to a breathtaking masterpiece encapsulates the magic of Diffusion Models. They’re a testament to how elegant mathematical principles, combined with powerful deep learning architectures, can lead to truly creative AI. It’s like teaching a machine the intricate art of sculpting, where it starts with a formless block of clay (noise) and meticulously carves away, step by step, guided by its learned understanding of what constitutes a “real” object.</p> <p>The field is still evolving at an incredible pace, with new architectures and techniques constantly pushing the boundaries of what’s possible. As a data science and ML enthusiast, diving into Diffusion Models has been an incredibly rewarding experience, revealing a whole new paradigm for generative AI. I hope this deep dive has sparked your curiosity and encourages you to explore the fascinating world where algorithms learn to create. The future of AI creation is here, and it’s diffusing!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/cracking-the-ai-black-box-why-explainable-ai-xai-i/">Cracking the AI Black Box: Why Explainable AI (XAI) is Our Superpower</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/the-secret-life-of-states-how-markov-chains-predic/">The Secret Life of States: How Markov Chains Predict Our Next Move (Without Remembering the Past!)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/gradient-descent-unpacking-the-engine-of-machine-l/">Gradient Descent: Unpacking the Engine of Machine Learning</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Adarsh Nair. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/blog/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/blog/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/blog/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/blog/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/blog/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/blog/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/blog/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/blog/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/blog/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/blog/assets/js/search-data.js"></script> <script src="/blog/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>