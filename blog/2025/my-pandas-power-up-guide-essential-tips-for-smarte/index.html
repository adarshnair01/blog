<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> My Pandas Power-Up Guide: Essential Tips for Smarter Data Science | Adarsh Nair </title> <meta name="author" content="Adarsh Nair"> <meta name="description" content="A deep dive into machine learning, AI, and data science. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; media-src 'self' https:; frame-src 'self' https:; connect-src 'self' https:;"> <link rel="stylesheet" href="/blog/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/blog/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/blog/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/blog/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/blog/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://adarshnair.online/blog/blog/blog/2025/my-pandas-power-up-guide-essential-tips-for-smarte/"> <script src="/blog/assets/js/theme.js?v=5fea5159b787642c1bbc1f334d60f883"></script> <link defer rel="stylesheet" href="/blog/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://adarshnair.online" rel="external nofollow noopener" target="_blank"> Adarsh Nair </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/blog/"> </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/index.html">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/about/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="https://adarshnair.online/books/" rel="external nofollow noopener" target="_blank">books </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">My Pandas Power-Up Guide: Essential Tips for Smarter Data Science</h1> <p class="post-meta"> Created on September 26, 2025 by Adarsh Nair </p> <p class="post-tags"> <a href="/blog/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/blog/tag/pandas"> <i class="fa-solid fa-hashtag fa-sm"></i> Pandas</a>   <a href="/blog/blog/tag/data-science"> <i class="fa-solid fa-hashtag fa-sm"></i> Data Science</a>   <a href="/blog/blog/tag/python"> <i class="fa-solid fa-hashtag fa-sm"></i> Python</a>   <a href="/blog/blog/tag/data-analysis"> <i class="fa-solid fa-hashtag fa-sm"></i> Data Analysis</a>   <a href="/blog/blog/tag/performance"> <i class="fa-solid fa-hashtag fa-sm"></i> Performance</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Hey everyone!</p> <p>If you’re anything like me, Pandas quickly became your best friend (and sometimes, your biggest puzzle) once you started working with data in Python. It’s the workhorse for almost every data scientist, analyst, or ML engineer out there. We use it to load, clean, transform, and analyze datasets of all shapes and sizes.</p> <p>But here’s the thing: while getting started with Pandas is relatively straightforward, truly mastering it – writing code that’s not just functional but also efficient, readable, and scalable – is a journey. Over time, I’ve had countless “aha!” moments, learning little tricks and deeper concepts that fundamentally changed how I approach data manipulation.</p> <p>Today, I want to share some of those essential Pandas tips that have significantly leveled up my data science game. Think of this as me opening up my personal journal, sharing the powerful tools I’ve added to my toolkit. Whether you’re just starting your data science journey or you’ve been around the block a few times, I hope you find some gems here!</p> <p>Let’s dive in!</p> <h3 id="1-embrace-vectorization-ditch-slow-apply-when-you-can">1. Embrace Vectorization: Ditch Slow <code class="language-plaintext highlighter-rouge">apply()</code> When You Can!</h3> <p>One of the earliest and most impactful lessons I learned was about performance. When you’re dealing with millions of rows, even a slight inefficiency can turn a quick script into a coffee break (or worse, a multi-day wait!).</p> <p>A common pitfall for beginners (and sometimes even experienced users) is over-relying on the <code class="language-plaintext highlighter-rouge">.apply()</code> method, especially with custom functions. While <code class="language-plaintext highlighter-rouge">.apply()</code> is incredibly flexible and powerful for row-wise or column-wise operations, it can be quite slow because, under the hood, it often iterates over rows or columns in Python, which is not as efficient as Pandas’ optimized C routines.</p> <p><strong>The Tip:</strong> Always prefer vectorized Pandas operations or NumPy functions over <code class="language-plaintext highlighter-rouge">.apply()</code> with custom Python functions when an equivalent exists.</p> <p>Let’s look at a quick example: squaring a numeric column.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">timeit</span>

<span class="c1"># Create a large DataFrame
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">1_000_000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Original DataFrame head:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="nf">head</span><span class="p">())</span>

<span class="c1"># Method 1: Using .apply() with a custom function
</span><span class="k">def</span> <span class="nf">square_num</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># %%timeit df['value_apply'] = df['value'].apply(square_num)
# This would be run in an IPython/Jupyter environment.
# For a script, we can use timeit module:
</span><span class="n">time_apply</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">.</span><span class="nf">timeit</span><span class="p">(</span><span class="sh">"</span><span class="s">df[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="s">].apply(square_num)</span><span class="sh">"</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nf">globals</span><span class="p">(),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Time taken with .apply(): </span><span class="si">{</span><span class="n">time_apply</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds</span><span class="sh">"</span><span class="p">)</span>


<span class="c1"># Method 2: Using vectorized operation (direct calculation)
</span><span class="n">time_vectorized_direct</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">.</span><span class="nf">timeit</span><span class="p">(</span><span class="sh">"</span><span class="s">df[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="s">]**2</span><span class="sh">"</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nf">globals</span><span class="p">(),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Time taken with vectorized direct: </span><span class="si">{</span><span class="n">time_vectorized_direct</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Method 3: Using NumPy vectorized function
</span><span class="n">time_vectorized_numpy</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">.</span><span class="nf">timeit</span><span class="p">(</span><span class="sh">"</span><span class="s">np.square(df[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="s">])</span><span class="sh">"</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nf">globals</span><span class="p">(),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Time taken with NumPy vectorized: </span><span class="si">{</span><span class="n">time_vectorized_numpy</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Verify results (they should be identical)
</span><span class="n">df_apply</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="n">square_num</span><span class="p">)</span>
<span class="n">df_vectorized_direct</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">df_vectorized_numpy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">square</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Results are identical:</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_apply</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="n">df_vectorized_direct</span><span class="p">)</span> <span class="ow">and</span> <span class="n">df_apply</span><span class="p">.</span><span class="nf">equals</span><span class="p">(</span><span class="n">df_vectorized_numpy</span><span class="p">))</span>
</code></pre></div></div> <p>You’ll notice that the vectorized direct operation and NumPy function are significantly faster, often by orders of magnitude! This is because Pandas and NumPy operations are implemented in highly optimized C or Fortran code, avoiding the overhead of Python’s interpreter loop. When you use <code class="language-plaintext highlighter-rouge">.apply()</code> with a Python function, you’re essentially telling Pandas to loop through your DataFrame row by row and execute your Python function for each one. This overhead can be substantial.</p> <p>In complexity terms, a vectorized operation on $N$ elements is typically $O(N)$ (linear time), as it performs a constant number of operations per element. An <code class="language-plaintext highlighter-rouge">.apply()</code> call, while also often $O(N)$ in terms of <em>iterations</em>, incurs a much higher constant factor due to Python function call overhead and data type conversions, making it slower in practice for many element-wise operations.</p> <p>While <code class="language-plaintext highlighter-rouge">.apply()</code> is indispensable for truly complex, row-dependent logic where no vectorized equivalent exists (e.g., parsing very complex strings with regex patterns that vary per row), always check for a vectorized alternative first.</p> <h3 id="2-precision-indexing-loc-iloc-at-and-iat-unveiled">2. Precision Indexing: <code class="language-plaintext highlighter-rouge">loc</code>, <code class="language-plaintext highlighter-rouge">iloc</code>, <code class="language-plaintext highlighter-rouge">at</code>, and <code class="language-plaintext highlighter-rouge">iat</code> Unveiled</h3> <p>One of the biggest hurdles for new Pandas users (and a source of frustrating bugs!) is understanding how to correctly select and assign data. The basic <code class="language-plaintext highlighter-rouge">df[]</code> syntax is powerful but can be ambiguous and lead to unexpected <code class="language-plaintext highlighter-rouge">SettingWithCopyWarning</code> messages.</p> <p><strong>The Tip:</strong> Master <code class="language-plaintext highlighter-rouge">loc</code> for label-based indexing and <code class="language-plaintext highlighter-rouge">iloc</code> for integer-position based indexing. For single-cell access, use <code class="language-plaintext highlighter-rouge">at</code> and <code class="language-plaintext highlighter-rouge">iat</code> for maximum speed.</p> <ul> <li> <strong><code class="language-plaintext highlighter-rouge">df.loc[]</code> (Label-based indexing):</strong> Use this when you know the <em>names</em> of the rows and columns you want. It’s inclusive of the end label for slices.</li> <li> <strong><code class="language-plaintext highlighter-rouge">df.iloc[]</code> (Integer-position based indexing):</strong> Use this when you know the <em>integer positions</em> (0-based) of the rows and columns, similar to NumPy array slicing. It’s exclusive of the end position for slices.</li> <li> <strong><code class="language-plaintext highlighter-rouge">df.at[]</code> (Label-based, single scalar access):</strong> Optimized for getting/setting a single value by row and column label. Much faster than <code class="language-plaintext highlighter-rouge">loc</code> for this specific use case.</li> <li> <strong><code class="language-plaintext highlighter-rouge">df.iat[]</code> (Integer-position based, single scalar access):</strong> Optimized for getting/setting a single value by integer row and column position. Much faster than <code class="language-plaintext highlighter-rouge">iloc</code> for this specific use case.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Alice</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bob</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Charlie</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">David</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">NY</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">LA</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">SF</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">NY</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">95</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">user1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">user2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">user3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">user4</span><span class="sh">'</span><span class="p">])</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Original DataFrame:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Using .loc[]
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">.loc[] examples:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Select row </span><span class="sh">'</span><span class="s">user2</span><span class="sh">'</span><span class="s"> and column </span><span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="sh">'</span><span class="s">user2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Select rows </span><span class="sh">'</span><span class="s">user1</span><span class="sh">'</span><span class="s"> to </span><span class="sh">'</span><span class="s">user3</span><span class="sh">'</span><span class="s"> and columns </span><span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="s"> to </span><span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="sh">'</span><span class="s">user1</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">user3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Select rows where age &gt; 30:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="sh">'</span><span class="s">user1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">88</span> <span class="c1"># Modifying a value safely
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Modified score for </span><span class="sh">'</span><span class="s">user1</span><span class="sh">'</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="sh">'</span><span class="s">user1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">])</span>


<span class="c1"># Using .iloc[]
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">.iloc[] examples:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Select row at index 1 and column at index 0 (Bob, name):</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Select first two rows and all columns:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Boston</span><span class="sh">'</span> <span class="c1"># Modifying a value safely
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Modified city for first row (index 0):</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># Using .at[] and .iat[] (for speed on single lookups)
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">.at[] and .iat[] examples:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Get score for </span><span class="sh">'</span><span class="s">user4</span><span class="sh">'</span><span class="s"> using .at[]:</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">at</span><span class="p">[</span><span class="sh">'</span><span class="s">user4</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">score</span><span class="sh">'</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Get city for row index 2, col index 2 using .iat[]:</span><span class="sh">"</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div></div> <p>By explicitly using <code class="language-plaintext highlighter-rouge">.loc</code> and <code class="language-plaintext highlighter-rouge">.iloc</code>, you make your code clearer, prevent unexpected behavior when chaining operations, and avoid the dreaded <code class="language-plaintext highlighter-rouge">SettingWithCopyWarning</code> which arises when Pandas thinks you’re trying to modify a view of a DataFrame rather than the original.</p> <h3 id="3-the-pipe-method--chaining-operations-with-panache">3. The <code class="language-plaintext highlighter-rouge">pipe()</code> Method – Chaining Operations with Panache</h3> <p>Ever found yourself writing long chains of Pandas operations, maybe using temporary variables, or indenting deeply? It can quickly become a messy spaghetti of code that’s hard to read and debug.</p> <p><strong>The Tip:</strong> Use the <code class="language-plaintext highlighter-rouge">.pipe()</code> method to create more readable and maintainable data transformation pipelines.</p> <p><code class="language-plaintext highlighter-rouge">pipe()</code> allows you to chain custom functions that take a DataFrame (or Series) as their first argument and return a DataFrame (or Series). This makes your data processing flow much more intuitive, reading from left to right, much like a Unix pipe.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">standardize_column</span><span class="p">(</span><span class="n">df_in</span><span class="p">,</span> <span class="n">column_name</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Standardizes a specified column (mean 0, std dev 1).</span><span class="sh">"""</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df_in</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span> <span class="c1"># Good practice to work on a copy if modifying
</span>    <span class="n">mean_val</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">].</span><span class="nf">mean</span><span class="p">()</span>
    <span class="n">std_val</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">].</span><span class="nf">std</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_val</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_val</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">rename_cols_upper</span><span class="p">(</span><span class="n">df_in</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Renames all columns to uppercase.</span><span class="sh">"""</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df_in</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Let's create a DataFrame with some missing values
</span><span class="n">df_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">z</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">]</span>
<span class="p">})</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Original DataFrame:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_raw</span><span class="p">)</span>

<span class="c1"># Without .pipe():
</span><span class="n">df_processed_no_pipe</span> <span class="o">=</span> <span class="n">df_raw</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
<span class="n">df_processed_no_pipe</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_processed_no_pipe</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="n">df_processed_no_pipe</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">())</span>
<span class="n">df_processed_no_pipe</span><span class="p">[</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_processed_no_pipe</span><span class="p">[</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_processed_no_pipe</span> <span class="o">=</span> <span class="nf">standardize_column</span><span class="p">(</span><span class="n">df_processed_no_pipe</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>
<span class="n">df_processed_no_pipe</span> <span class="o">=</span> <span class="nf">rename_cols_upper</span><span class="p">(</span><span class="n">df_processed_no_pipe</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Processed without .pipe():</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_processed_no_pipe</span><span class="p">)</span>

<span class="c1"># With .pipe():
</span><span class="n">df_processed_with_pipe</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_raw</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
                          <span class="p">.</span><span class="nf">assign</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">()))</span> <span class="c1"># Using assign for column creation/modification
</span>                          <span class="p">.</span><span class="nf">assign</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                          <span class="p">.</span><span class="nf">pipe</span><span class="p">(</span><span class="n">standardize_column</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>
                          <span class="p">.</span><span class="nf">pipe</span><span class="p">(</span><span class="n">rename_cols_upper</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Processed with .pipe():</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_processed_with_pipe</span><span class="p">)</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">.pipe()</code> approach makes the sequence of operations explicit and easy to follow. Each step is a function that takes the current state of the DataFrame and returns a new (or modified) one, enhancing readability and making debugging simpler by isolating transformations.</p> <h3 id="4-turbocharge-with-categorical-dtype-memory-and-speed-wins">4. Turbocharge with <code class="language-plaintext highlighter-rouge">Categorical</code> Dtype: Memory and Speed Wins!</h3> <p>Working with large datasets can quickly eat up your system’s memory and slow down operations. One powerful optimization that often goes overlooked is using the <code class="language-plaintext highlighter-rouge">Categorical</code> dtype.</p> <p><strong>The Tip:</strong> Convert columns with a limited number of unique values (low cardinality), especially strings, to the <code class="language-plaintext highlighter-rouge">Categorical</code> dtype.</p> <p>How does it work? Instead of storing each string repeatedly, Pandas stores an efficient array of integer “codes” representing the categories, along with a separate mapping of these codes to the actual string values. This is incredibly efficient for memory.</p> <p>Let’s illustrate with an example:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_size</span> <span class="o">=</span> <span class="mi">1_000_000</span>
<span class="n">cities</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">New York</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Los Angeles</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Chicago</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Houston</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Phoenix</span><span class="sh">'</span><span class="p">]</span>
<span class="n">df_large</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="nf">range</span><span class="p">(</span><span class="n">data_size</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">city_obj</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">cities</span><span class="p">,</span> <span class="n">data_size</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">temp</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">data_size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">10</span> <span class="c1"># Random temperature
</span><span class="p">})</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Original DataFrame info (object dtype for city):</span><span class="sh">"</span><span class="p">)</span>
<span class="n">df_large</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="sh">'</span><span class="s">deep</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Convert 'city_obj' to 'category'
</span><span class="n">df_large</span><span class="p">[</span><span class="sh">'</span><span class="s">city_cat</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_large</span><span class="p">[</span><span class="sh">'</span><span class="s">city_obj</span><span class="sh">'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">DataFrame info after converting </span><span class="sh">'</span><span class="s">city_obj</span><span class="sh">'</span><span class="s"> to </span><span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
<span class="n">df_large</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="sh">'</span><span class="s">deep</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Let's compare memory usage more explicitly
</span><span class="n">obj_memory</span> <span class="o">=</span> <span class="n">df_large</span><span class="p">[</span><span class="sh">'</span><span class="s">city_obj</span><span class="sh">'</span><span class="p">].</span><span class="nf">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">cat_memory</span> <span class="o">=</span> <span class="n">df_large</span><span class="p">[</span><span class="sh">'</span><span class="s">city_cat</span><span class="sh">'</span><span class="p">].</span><span class="nf">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Memory usage for </span><span class="sh">'</span><span class="s">city_obj</span><span class="sh">'</span><span class="s">: </span><span class="si">{</span><span class="n">obj_memory</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Memory usage for </span><span class="sh">'</span><span class="s">city_cat</span><span class="sh">'</span><span class="s">: </span><span class="si">{</span><span class="n">cat_memory</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Memory saved: </span><span class="si">{</span><span class="p">(</span><span class="n">obj_memory</span> <span class="o">-</span> <span class="n">cat_memory</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Performance benefits for operations like groupby
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Time for groupby on object dtype:</span><span class="sh">"</span><span class="p">)</span>
<span class="n">time_obj_groupby</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">.</span><span class="nf">timeit</span><span class="p">(</span><span class="sh">"</span><span class="s">df_large.groupby(</span><span class="sh">'</span><span class="s">city_obj</span><span class="sh">'</span><span class="s">)[</span><span class="sh">'</span><span class="s">temp</span><span class="sh">'</span><span class="s">].mean()</span><span class="sh">"</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nf">globals</span><span class="p">(),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Time with object dtype: </span><span class="si">{</span><span class="n">time_obj_groupby</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Time for groupby on categorical dtype:</span><span class="sh">"</span><span class="p">)</span>
<span class="n">time_cat_groupby</span> <span class="o">=</span> <span class="n">timeit</span><span class="p">.</span><span class="nf">timeit</span><span class="p">(</span><span class="sh">"</span><span class="s">df_large.groupby(</span><span class="sh">'</span><span class="s">city_cat</span><span class="sh">'</span><span class="s">)[</span><span class="sh">'</span><span class="s">temp</span><span class="sh">'</span><span class="s">].mean()</span><span class="sh">"</span><span class="p">,</span> <span class="nb">globals</span><span class="o">=</span><span class="nf">globals</span><span class="p">(),</span> <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Time with categorical dtype: </span><span class="si">{</span><span class="n">time_cat_groupby</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>You’ll see a dramatic reduction in memory usage, especially for columns with long string values or a high number of repeated values. The memory consumed by a categorical column can be approximated as $N \times S_{int} + C \times S_{str}$, where $N$ is the number of rows, $S_{int}$ is the memory for an integer code (e.g., 1, 2, 4 bytes), $C$ is the number of unique categories, and $S_{str}$ is the average memory for a string in the categories. Compare this to storing $N \times S_{str}$ for an object column, and the savings are clear for large $N$ and small $C$.</p> <p>Beyond memory, operations like <code class="language-plaintext highlighter-rouge">groupby()</code> and sorting can also be significantly faster on <code class="language-plaintext highlighter-rouge">Categorical</code> data because Pandas can work with the underlying integer codes instead of comparing strings.</p> <h3 id="5-reshaping-for-insight-melt-and-pivot_table">5. Reshaping for Insight: <code class="language-plaintext highlighter-rouge">melt()</code> and <code class="language-plaintext highlighter-rouge">pivot_table()</code> </h3> <p>Data often comes in formats that aren’t ideal for analysis or machine learning models. Sometimes it’s “wide,” with many columns representing different measurements or time points. Other times it’s “long,” with a single column containing variable types and another for their values. Learning to fluidly switch between these formats is a superpower!</p> <p><strong>The Tip:</strong> Use <code class="language-plaintext highlighter-rouge">pd.melt()</code> to transform wide data into a long format, and <code class="language-plaintext highlighter-rouge">df.pivot_table()</code> to transform long data back into a wide format (with aggregation).</p> <ul> <li> <strong><code class="language-plaintext highlighter-rouge">pd.melt()</code> (Wide to Long):</strong> Useful when column headers are actually values, not distinct variables.</li> <li> <strong><code class="language-plaintext highlighter-rouge">df.pivot_table()</code> (Long to Wide):</strong> Useful for summarizing data, creating cross-tabulations, or reorganizing data based on specific index, column, and value combinations.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Wide data example: Monthly sales for different products
</span><span class="n">sales_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">Product</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">Jan_Sales</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">Feb_Sales</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">Mar_Sales</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df_wide</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Wide DataFrame (Monthly Sales):</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_wide</span><span class="p">)</span>

<span class="c1"># Melt the DataFrame to long format
</span><span class="n">df_long</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">melt</span><span class="p">(</span><span class="n">df_wide</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Product</span><span class="sh">'</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="sh">'</span><span class="s">Month</span><span class="sh">'</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="sh">'</span><span class="s">Sales</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Melted (Long) DataFrame:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_long</span><span class="p">)</span>

<span class="c1"># Now, let's create some more 'long' data for pivoting
</span><span class="n">df_sensor</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">DeviceID</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">A1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A2</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">Timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">([</span><span class="sh">'</span><span class="s">2023-01-01 10:00</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2023-01-01 11:00</span><span class="sh">'</span><span class="p">,</span>
                                 <span class="sh">'</span><span class="s">2023-01-01 10:00</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2023-01-01 11:00</span><span class="sh">'</span><span class="p">,</span>
                                 <span class="sh">'</span><span class="s">2023-01-02 10:00</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2023-01-02 10:00</span><span class="sh">'</span><span class="p">]),</span>
    <span class="sh">'</span><span class="s">SensorType</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Temp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Humidity</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Temp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Humidity</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Temp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Humidity</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">Value</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mf">25.5</span><span class="p">,</span> <span class="mf">60.2</span><span class="p">,</span> <span class="mf">24.1</span><span class="p">,</span> <span class="mf">65.1</span><span class="p">,</span> <span class="mf">26.0</span><span class="p">,</span> <span class="mf">62.5</span><span class="p">]</span>
<span class="p">})</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Long Sensor Data:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_sensor</span><span class="p">)</span>

<span class="c1"># Pivot to get Temp and Humidity as separate columns per DeviceID and Timestamp
</span><span class="n">df_pivot</span> <span class="o">=</span> <span class="n">df_sensor</span><span class="p">.</span><span class="nf">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">DeviceID</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Timestamp</span><span class="sh">'</span><span class="p">],</span>
                                 <span class="n">columns</span><span class="o">=</span><span class="sh">'</span><span class="s">SensorType</span><span class="sh">'</span><span class="p">,</span>
                                 <span class="n">values</span><span class="o">=</span><span class="sh">'</span><span class="s">Value</span><span class="sh">'</span><span class="p">,</span>
                                 <span class="n">aggfunc</span><span class="o">=</span><span class="sh">'</span><span class="s">first</span><span class="sh">'</span><span class="p">).</span><span class="nf">reset_index</span><span class="p">()</span> <span class="c1"># Use first to avoid aggregation if unique
</span><span class="n">df_pivot</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span> <span class="c1"># Remove the column name for 'SensorType'
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Pivoted Sensor Data:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_pivot</span><span class="p">)</span>
</code></pre></div></div> <p>These functions are invaluable for transforming data into the “tidy” format often required by machine learning libraries (where each row is an observation, and each column is a variable) or for creating insightful summary tables for reports and dashboards.</p> <h3 id="6-expressive-filtering-with-query">6. Expressive Filtering with <code class="language-plaintext highlighter-rouge">query()</code> </h3> <p>Filtering DataFrames is a bread-and-butter operation, usually done with boolean indexing using square brackets <code class="language-plaintext highlighter-rouge">df[df['col'] &gt; value]</code>. While effective, complex conditions with multiple <code class="language-plaintext highlighter-rouge">and</code> or <code class="language-plaintext highlighter-rouge">or</code> operators can quickly become unwieldy and hard to read.</p> <p><strong>The Tip:</strong> Use the <code class="language-plaintext highlighter-rouge">.query()</code> method for more readable and expressive DataFrame filtering, especially for complex conditions.</p> <p><code class="language-plaintext highlighter-rouge">query()</code> allows you to filter a DataFrame using a string expression, much like SQL’s <code class="language-plaintext highlighter-rouge">WHERE</code> clause. It can significantly improve the clarity of your code.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">product</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Apple</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Banana</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Orange</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Apple</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Banana</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Orange</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">East</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">East</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">East</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">quantity</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df_sales</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Original Sales Data:</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">df_sales</span><span class="p">)</span>

<span class="c1"># Traditional boolean indexing
</span><span class="n">filtered_df_bool</span> <span class="o">=</span> <span class="n">df_sales</span><span class="p">[(</span><span class="n">df_sales</span><span class="p">[</span><span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_sales</span><span class="p">[</span><span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="p">)]</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Filtered (boolean indexing) (sales &gt; 100 AND region == </span><span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="s">):</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">filtered_df_bool</span><span class="p">)</span>

<span class="c1"># Using .query()
</span><span class="n">filtered_df_query</span> <span class="o">=</span> <span class="n">df_sales</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="sh">"</span><span class="s">sales &gt; 100 and region == </span><span class="sh">'</span><span class="s">West</span><span class="sh">'"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Filtered (.query()) (sales &gt; 100 AND region == </span><span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="s">):</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">filtered_df_query</span><span class="p">)</span>

<span class="c1"># More complex query with variables
</span><span class="n">min_sales_threshold</span> <span class="o">=</span> <span class="mi">110</span>
<span class="n">target_product</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Apple</span><span class="sh">'</span>

<span class="n">filtered_complex_query</span> <span class="o">=</span> <span class="n">df_sales</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="sh">"</span><span class="s">sales &gt;= @min_sales_threshold and product == @target_product or quantity &gt; 10</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Filtered (complex .query() with variables) (sales &gt;= </span><span class="si">{</span><span class="n">min_sales_threshold</span><span class="si">}</span><span class="s"> AND product == </span><span class="sh">'</span><span class="si">{</span><span class="n">target_product</span><span class="si">}</span><span class="sh">'</span><span class="s"> OR quantity &gt; 10):</span><span class="se">\n</span><span class="sh">"</span><span class="p">,</span> <span class="n">filtered_complex_query</span><span class="p">)</span>
</code></pre></div></div> <p>Notice how <code class="language-plaintext highlighter-rouge">query()</code> makes the condition much easier to read, especially when combining multiple criteria with <code class="language-plaintext highlighter-rouge">and</code> and <code class="language-plaintext highlighter-rouge">or</code>. You can even reference Python variables within your query string using the <code class="language-plaintext highlighter-rouge">@</code> prefix, which is a neat touch for dynamic filtering.</p> <h3 id="conclusion">Conclusion</h3> <p>Pandas is an incredibly powerful library, and like any powerful tool, it has its nuances. The tips I’ve shared today – embracing vectorization, mastering precise indexing, chaining operations with <code class="language-plaintext highlighter-rouge">pipe()</code>, optimizing memory with <code class="language-plaintext highlighter-rouge">Categorical</code> types, reshaping data with <code class="language-plaintext highlighter-rouge">melt()</code> and <code class="language-plaintext highlighter-rouge">pivot_table()</code>, and cleaning up filters with <code class="language-plaintext highlighter-rouge">query()</code> – are just a few examples of how you can write cleaner, faster, and more effective data manipulation code.</p> <p>The journey to becoming a proficient data scientist is all about continuous learning and refinement. Don’t be afraid to dive into the documentation, experiment with different approaches, and learn from others. Each little trick you pick up adds another superpower to your data science arsenal.</p> <p>Keep exploring, keep coding, and happy data wrangling!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/cracking-the-ai-black-box-why-explainable-ai-xai-i/">Cracking the AI Black Box: Why Explainable AI (XAI) is Our Superpower</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/the-secret-life-of-states-how-markov-chains-predic/">The Secret Life of States: How Markov Chains Predict Our Next Move (Without Remembering the Past!)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/gradient-descent-unpacking-the-engine-of-machine-l/">Gradient Descent: Unpacking the Engine of Machine Learning</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Adarsh Nair. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/blog/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/blog/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/blog/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/blog/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/blog/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/blog/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/blog/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/blog/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/blog/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/blog/assets/js/search-data.js"></script> <script src="/blog/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>