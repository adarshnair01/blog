<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Unlocking Pandas Superpowers: My 7 Secret Weapons for Data Dominance | Adarsh Nair </title> <meta name="author" content="Adarsh Nair"> <meta name="description" content="A deep dive into machine learning, AI, and data science. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; media-src 'self' https:; frame-src 'self' https:; connect-src 'self' https:;"> <link rel="stylesheet" href="/blog/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/blog/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/blog/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/blog/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/blog/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://adarshnair.online/blog/blog/blog/2026/unlocking-pandas-superpowers-my-7-secret-weapons-f/"> <script src="/blog/assets/js/theme.js?v=5fea5159b787642c1bbc1f334d60f883"></script> <link defer rel="stylesheet" href="/blog/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://adarshnair.online" rel="external nofollow noopener" target="_blank"> Adarsh Nair </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/blog/"> </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/index.html">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="https://adarshnair.online/books/" rel="external nofollow noopener" target="_blank">books </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Unlocking Pandas Superpowers: My 7 Secret Weapons for Data Dominance</h1> <p class="post-meta"> Created on January 04, 2026 by Adarsh Nair </p> <p class="post-tags"> <a href="/blog/blog/2026"> <i class="fa-solid fa-calendar fa-sm"></i> 2026 </a>   ·   <a href="/blog/blog/tag/pandas"> <i class="fa-solid fa-hashtag fa-sm"></i> Pandas</a>   <a href="/blog/blog/tag/data-science"> <i class="fa-solid fa-hashtag fa-sm"></i> Data Science</a>   <a href="/blog/blog/tag/python"> <i class="fa-solid fa-hashtag fa-sm"></i> Python</a>   <a href="/blog/blog/tag/data-analysis"> <i class="fa-solid fa-hashtag fa-sm"></i> Data Analysis</a>   <a href="/blog/blog/tag/machine-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> Machine Learning</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Hey fellow data adventurers!</p> <p>Ever stared at a tangled mess of data, feeling like you’re trying to untie a Gordian knot with a spoon? I’ve been there. Many times. When I first started diving into the world of data science, Pandas felt like a magical key, but sometimes the lock was still tricky to open.</p> <p>But through countless hours of wrestling with datasets, I’ve discovered some “superpowers” – little tricks and techniques in Pandas that don’t just solve problems, they make the whole process faster, cleaner, and honestly, a lot more fun. Think of this as my personal journal entry, sharing the tried-and-true methods I now swear by. If you’re just starting your data science journey, or even if you’ve been around the block a few times, I promise there’s something here to make your data wrangling a little easier.</p> <p>Let’s dive in!</p> <h3 id="1-the-art-of-chaining-pipe-assign-and-agg-for-beautiful-workflows">1. The Art of Chaining: <code class="language-plaintext highlighter-rouge">pipe()</code>, <code class="language-plaintext highlighter-rouge">assign()</code>, and <code class="language-plaintext highlighter-rouge">agg()</code> for Beautiful Workflows</h3> <p>Have you ever written code that looks like this?</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># Sample Data
</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">New York</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">London</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Paris</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">New York</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">London</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Paris</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">humidity</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">precipitation_mm</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Traditional, step-by-step approach
</span><span class="n">df_step1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">df_step2</span> <span class="o">=</span> <span class="n">df_step1</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span> <span class="c1"># Good practice to avoid SettingWithCopyWarning
</span><span class="n">df_step2</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature_f</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_step2</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span>
<span class="n">final_df</span> <span class="o">=</span> <span class="n">df_step2</span><span class="p">[[</span><span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">temperature_f</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">humidity</span><span class="sh">'</span><span class="p">]]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">final_df</span><span class="p">)</span>
</code></pre></div></div> <p>It works, but it creates a bunch of intermediate variables (<code class="language-plaintext highlighter-rouge">df_step1</code>, <code class="language-plaintext highlighter-rouge">df_step2</code>). This can make your code harder to read, debug, and takes up more memory if your data is huge. Enter method chaining!</p> <p><strong><code class="language-plaintext highlighter-rouge">assign()</code> for New Columns:</strong> Instead of <code class="language-plaintext highlighter-rouge">df['new_col'] = ...</code>, use <code class="language-plaintext highlighter-rouge">.assign()</code>. It returns a <em>new</em> DataFrame with the column added, allowing you to keep chaining.</p> <p><strong><code class="language-plaintext highlighter-rouge">pipe()</code> for Custom Functions:</strong> What if you have a custom function that takes a DataFrame and returns a DataFrame? <code class="language-plaintext highlighter-rouge">pipe()</code> is your friend. It allows you to insert any function into your chain.</p> <p>Let’s rewrite the example above using chaining:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Chained approach using assign() and filtering directly
</span><span class="n">processed_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span> <span class="c1"># Filter rows
</span>    <span class="p">.</span><span class="nf">assign</span><span class="p">(</span><span class="n">temperature_f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="c1"># Create new column
</span>    <span class="p">.</span><span class="nf">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df_filtered</span><span class="p">:</span> <span class="n">df_filtered</span><span class="p">[[</span><span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">temperature_f</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">humidity</span><span class="sh">'</span><span class="p">]])</span> <span class="c1"># Select columns
</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Processed DataFrame (chained):</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">processed_df</span><span class="p">)</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">lambda x:</code> inside <code class="language-plaintext highlighter-rouge">assign()</code> means “for each row <code class="language-plaintext highlighter-rouge">x</code> in the current DataFrame, calculate the Fahrenheit temperature.” The <code class="language-plaintext highlighter-rouge">lambda df_filtered:</code> inside <code class="language-plaintext highlighter-rouge">pipe()</code> allows us to pass the <em>entire</em> DataFrame at that stage of the chain to a function (in this case, just column selection). This makes your code flow like a well-oiled machine!</p> <h3 id="2-vectorization-ditching-loops-for-lightning-speed">2. Vectorization: Ditching Loops for Lightning Speed</h3> <p>One of the most common pitfalls I see (and definitely fell into myself) is using Python <code class="language-plaintext highlighter-rouge">for</code> loops to process data in a Pandas DataFrame. While Python loops are versatile, they are notoriously slow for large datasets. Why? Because Pandas operations are often “vectorized,” meaning they are implemented in highly optimized C code under the hood.</p> <p>Consider calculating the square of a column:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The SLOW way (avoid this!)
</span><span class="k">def</span> <span class="nf">square_slow</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">]:</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">val</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">temp_sq_slow</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">square_slow</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># The FAST way (vectorized)
</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">temp_sq_fast</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">DataFrame with squared temperatures:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="sh">'</span><span class="s">temperature_c</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">temp_sq_slow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">temp_sq_fast</span><span class="sh">'</span><span class="p">]])</span>
</code></pre></div></div> <p>Notice how <code class="language-plaintext highlighter-rouge">df['temperature_c']**2</code> directly applies the squaring operation to <em>every element</em> in the column simultaneously. This is what vectorization looks like.</p> <p><strong>When to vectorize:</strong></p> <ul> <li>Arithmetic operations (<code class="language-plaintext highlighter-rouge">+</code>, <code class="language-plaintext highlighter-rouge">-</code>, <code class="language-plaintext highlighter-rouge">*</code>, <code class="language-plaintext highlighter-rouge">/</code>, <code class="language-plaintext highlighter-rouge">**</code>)</li> <li>Comparison operations (<code class="language-plaintext highlighter-rouge">&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;</code>, <code class="language-plaintext highlighter-rouge">==</code>)</li> <li>String operations (using the <code class="language-plaintext highlighter-rouge">.str</code> accessor, which we’ll cover next!)</li> <li>Many NumPy functions (e.g., <code class="language-plaintext highlighter-rouge">np.log</code>, <code class="language-plaintext highlighter-rouge">np.sqrt</code>)</li> </ul> <p>Whenever you find yourself writing a <code class="language-plaintext highlighter-rouge">for</code> loop over DataFrame rows, pause! There’s almost always a faster, vectorized Pandas or NumPy way to do it.</p> <h3 id="3-grouping-power-mastering-groupby-and-agg">3. Grouping Power: Mastering <code class="language-plaintext highlighter-rouge">groupby()</code> and <code class="language-plaintext highlighter-rouge">agg()</code> </h3> <p>If data analysis were a superhero team, <code class="language-plaintext highlighter-rouge">groupby()</code> would be the tactical leader, organizing everything into logical units. It allows you to split your data into groups based on one or more criteria, apply a function to each group independently, and then combine the results.</p> <p>Imagine you have sales data and want to know the total sales per region. <code class="language-plaintext highlighter-rouge">groupby()</code> is your answer.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># More sample data
</span><span class="n">sales_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">North</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">South</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">North</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">South</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">North</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">West</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">product</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">110</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">sales_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span>

<span class="c1"># Basic Groupby: Sum sales by region
</span><span class="n">regional_sales</span> <span class="o">=</span> <span class="n">sales_df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">].</span><span class="nf">sum</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Regional Sales Sum:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">regional_sales</span><span class="p">)</span>

<span class="c1"># Groupby with multiple aggregations using agg()
# Let's find mean and max sales per region
</span><span class="n">region_stats</span> <span class="o">=</span> <span class="n">sales_df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">)[</span><span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">].</span><span class="nf">agg</span><span class="p">([</span><span class="sh">'</span><span class="s">mean</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">max</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Regional Sales Statistics:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">region_stats</span><span class="p">)</span>

<span class="c1"># Custom aggregations: multiple columns, multiple functions
</span><span class="n">custom_agg</span> <span class="o">=</span> <span class="n">sales_df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">).</span><span class="nf">agg</span><span class="p">(</span>
    <span class="n">total_sales</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">sum</span><span class="sh">'</span><span class="p">),</span>
    <span class="n">avg_humidity</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">humidity</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">mean</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># Assuming 'humidity' was in sales_df, for example
</span>    <span class="c1"># Let's use temperature_c from our first df instead for realism
</span>    <span class="c1"># To make this example runnable, let's just make up 'humidity' for sales_df
</span><span class="p">)</span>
<span class="n">sales_df</span><span class="p">[</span><span class="sh">'</span><span class="s">humidity</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span> <span class="c1"># Adding humidity for this example
</span>
<span class="n">custom_agg</span> <span class="o">=</span> <span class="n">sales_df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">).</span><span class="nf">agg</span><span class="p">(</span>
    <span class="n">total_sales</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">sum</span><span class="sh">'</span><span class="p">),</span>
    <span class="n">avg_humidity</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">humidity</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">mean</span><span class="sh">'</span><span class="p">),</span>
    <span class="n">num_products</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">product</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># Number of unique products sold in that region
</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Custom Aggregations per Region:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">custom_agg</span><span class="p">)</span>
</code></pre></div></div> <p>The formula for the mean (average) for a group $G$ with $N_G$ data points $x_i$ is given by: \(\bar{x}_G = \frac{1}{N_G} \sum_{i=1}^{N_G} x_i\) <code class="language-plaintext highlighter-rouge">groupby().mean()</code> calculates this for each group automatically! <code class="language-plaintext highlighter-rouge">agg()</code> is incredibly powerful because it allows you to specify different aggregation functions for different columns, or multiple functions for the same column, all in one go.</p> <h3 id="4-string-operations-the-str-accessor">4. String Operations: The <code class="language-plaintext highlighter-rouge">.str</code> Accessor</h3> <p>Text data is everywhere, and it’s often messy. Cleaning, transforming, or extracting information from strings is a common task. Pandas provides a special <code class="language-plaintext highlighter-rouge">.str</code> accessor for Series of strings, allowing you to apply string methods that are similar to Python’s built-in string methods, but in a vectorized way!</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># New sample data with string issues
</span><span class="n">text_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">product_id</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">  A123  </span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">B456-</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">c789X</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">D101_</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">description</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Fast processor</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Loud speaker!</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Waterproof case</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Long battery life.</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">Electronics</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Audio</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Accessories</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Electronics</span><span class="sh">'</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">text_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">text_data</span><span class="p">)</span>

<span class="c1"># Cleaning product_id: removing leading/trailing spaces and specific characters
</span><span class="n">text_df</span><span class="p">[</span><span class="sh">'</span><span class="s">product_id_clean</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_df</span><span class="p">[</span><span class="sh">'</span><span class="s">product_id</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">strip</span><span class="p">().</span><span class="nb">str</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span>

<span class="c1"># Checking for keywords in description
</span><span class="n">text_df</span><span class="p">[</span><span class="sh">'</span><span class="s">has_processor</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_df</span><span class="p">[</span><span class="sh">'</span><span class="s">description</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="sh">'</span><span class="s">processor</span><span class="sh">'</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># Extracting first word from description
</span><span class="n">text_df</span><span class="p">[</span><span class="sh">'</span><span class="s">first_word</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_df</span><span class="p">[</span><span class="sh">'</span><span class="s">description</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Text Data with String Operations:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">text_df</span><span class="p">)</span>
</code></pre></div></div> <p>Notice how you can chain <code class="language-plaintext highlighter-rouge">.str</code> methods too! <code class="language-plaintext highlighter-rouge">str.strip().str.replace().str.upper()</code> is much cleaner and more efficient than looping through each string manually. This is a huge time-saver when dealing with user-generated content or raw text files.</p> <h3 id="5-categorical-data-memory-and-speed-boosts">5. Categorical Data: Memory and Speed Boosts</h3> <p>Imagine you have a column like <code class="language-plaintext highlighter-rouge">country</code> with values ‘USA’, ‘Canada’, ‘Mexico’, ‘USA’, ‘Canada’, etc. If you have millions of rows, storing these strings repeatedly takes up a lot of memory. A “categorical” data type in Pandas can save you a ton of memory and even speed up operations like <code class="language-plaintext highlighter-rouge">groupby()</code>.</p> <p>A categorical column stores only the <em>unique</em> values (the “categories”) once, and then stores integer codes referring to these categories for each row.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Data with many repeating strings
</span><span class="n">countries</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">USA</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Canada</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mexico</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">USA</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Canada</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100_000</span> <span class="c1"># 500,000 rows
</span><span class="n">large_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">country</span><span class="sh">'</span><span class="p">:</span> <span class="n">countries</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">500_000</span><span class="p">)})</span>

<span class="c1"># Check memory usage before conversion
</span><span class="n">memory_before</span> <span class="o">=</span> <span class="n">large_df</span><span class="p">[</span><span class="sh">'</span><span class="s">country</span><span class="sh">'</span><span class="p">].</span><span class="nf">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Memory usage (before categorical conversion): </span><span class="si">{</span><span class="n">memory_before</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Convert to categorical type
</span><span class="n">large_df</span><span class="p">[</span><span class="sh">'</span><span class="s">country_cat</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">large_df</span><span class="p">[</span><span class="sh">'</span><span class="s">country</span><span class="sh">'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Check memory usage after conversion
</span><span class="n">memory_after</span> <span class="o">=</span> <span class="n">large_df</span><span class="p">[</span><span class="sh">'</span><span class="s">country_cat</span><span class="sh">'</span><span class="p">].</span><span class="nf">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Memory usage (after categorical conversion): </span><span class="si">{</span><span class="n">memory_after</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> MB</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Notice the significant memory saving!
</span></code></pre></div></div> <p>The memory saving can be quite dramatic, especially when the number of unique categories is small compared to the total number of rows. For a column with $N$ rows and $C$ unique categories, storing as strings might take $N \times L_{avg}$ bytes (where $L_{avg}$ is average string length), while categorical might take $C \times L_{cat} + N \times S_{int}$ bytes (where $L_{cat}$ is category string length, $S_{int}$ is integer size for codes). When $N$ is large and $C$ is small, the saving is huge.</p> <p>Beyond memory, <code class="language-plaintext highlighter-rouge">groupby()</code> and other operations on categorical columns can be significantly faster because Pandas is comparing and sorting integers instead of strings.</p> <h3 id="6-time-series-magic-dt-accessor-and-resample">6. Time Series Magic: <code class="language-plaintext highlighter-rouge">.dt</code> Accessor and <code class="language-plaintext highlighter-rouge">resample()</code> </h3> <p>Working with dates and times is a cornerstone of many data science projects. Pandas has excellent tools for this, especially when your DataFrame’s index is a <code class="language-plaintext highlighter-rouge">DateTimeIndex</code>.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Time series data
</span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="sh">'</span><span class="s">2023-01-01</span><span class="sh">'</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="sh">'</span><span class="s">H</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># 100 hours of data
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">temp_values</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">time_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">temperature</span><span class="sh">'</span><span class="p">:</span> <span class="n">temp_values</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>

<span class="c1"># Using .dt accessor to extract date components
</span><span class="n">time_df</span><span class="p">[</span><span class="sh">'</span><span class="s">hour</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">dt</span><span class="p">.</span><span class="n">hour</span>
<span class="n">time_df</span><span class="p">[</span><span class="sh">'</span><span class="s">day_of_week</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">dt</span><span class="p">.</span><span class="nf">day_name</span><span class="p">()</span>
<span class="n">time_df</span><span class="p">[</span><span class="sh">'</span><span class="s">is_weekend</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">dt</span><span class="p">.</span><span class="n">dayofweek</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="c1"># Monday=0, Sunday=6
</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Time Series Data with .dt accessor:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">time_df</span><span class="p">.</span><span class="nf">head</span><span class="p">())</span>

<span class="c1"># Resampling data: e.g., hourly to daily average
</span><span class="n">daily_avg_temp</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature</span><span class="sh">'</span><span class="p">].</span><span class="nf">resample</span><span class="p">(</span><span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">).</span><span class="nf">mean</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Daily Average Temperature (Resampled):</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">daily_avg_temp</span><span class="p">.</span><span class="nf">head</span><span class="p">())</span>

<span class="c1"># Resampling to weekly sum
</span><span class="n">weekly_sum_temp</span> <span class="o">=</span> <span class="n">time_df</span><span class="p">[</span><span class="sh">'</span><span class="s">temperature</span><span class="sh">'</span><span class="p">].</span><span class="nf">resample</span><span class="p">(</span><span class="sh">'</span><span class="s">W</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span> <span class="c1"># For cumulative data
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Weekly Sum Temperature (Resampled):</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">weekly_sum_temp</span><span class="p">.</span><span class="nf">head</span><span class="p">())</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">.dt</code> accessor allows you to pull out specific parts of a datetime object (year, month, day, hour, minute, day of week, etc.) just like the <code class="language-plaintext highlighter-rouge">.str</code> accessor does for strings.</p> <p><code class="language-plaintext highlighter-rouge">resample()</code> is like <code class="language-plaintext highlighter-rouge">groupby()</code> but specifically for time-based intervals. It’s incredibly powerful for aggregating data over different time frequencies (e.g., from minute-by-minute sensor readings to hourly averages, or daily sales to monthly totals).</p> <h3 id="7-the-power-of-stack-and-unstack-for-reshaping-data">7. The Power of <code class="language-plaintext highlighter-rouge">stack()</code> and <code class="language-plaintext highlighter-rouge">unstack()</code> for Reshaping Data</h3> <p>Sometimes your data isn’t in the ideal format for analysis or visualization. This is where <code class="language-plaintext highlighter-rouge">stack()</code> and <code class="language-plaintext highlighter-rouge">unstack()</code> come in handy – they’re like flipping your data on its side, making rows into columns or vice-versa, especially useful with MultiIndex DataFrames.</p> <p><code class="language-plaintext highlighter-rouge">stack()</code> rotates columns into rows, creating a MultiIndex (think of it as “stacking” the columns on top of each other into a new level of index). <code class="language-plaintext highlighter-rouge">unstack()</code> does the opposite, rotating index levels into columns (think of “unstacking” an index level to make it wider).</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Sample data for stacking/unstacking
</span><span class="n">multi_index_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">New York</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">London</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Paris</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">New York</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">London</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Paris</span><span class="sh">'</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">year</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">2022</span><span class="p">,</span> <span class="mi">2022</span><span class="p">,</span> <span class="mi">2023</span><span class="p">,</span> <span class="mi">2023</span><span class="p">,</span> <span class="mi">2023</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">sales</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
    <span class="sh">'</span><span class="s">expenses</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">45</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Set a MultiIndex for better illustration
</span><span class="n">df_indexed</span> <span class="o">=</span> <span class="n">multi_index_df</span><span class="p">.</span><span class="nf">set_index</span><span class="p">([</span><span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">year</span><span class="sh">'</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Original MultiIndex DataFrame:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df_indexed</span><span class="p">)</span>

<span class="c1"># Stacking: Convert columns ('sales', 'expenses') into a new index level
</span><span class="n">df_stacked</span> <span class="o">=</span> <span class="n">df_indexed</span><span class="p">.</span><span class="nf">stack</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">DataFrame after stacking:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df_stacked</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">type</span><span class="p">(</span><span class="n">df_stacked</span><span class="p">))</span> <span class="c1"># It becomes a Series with a MultiIndex
</span>
<span class="c1"># Unstacking: Rotate a level of the index into columns
# Let's unstack the 'year' from the index to become columns
</span><span class="n">df_unstacked_year</span> <span class="o">=</span> <span class="n">df_indexed</span><span class="p">.</span><span class="nf">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="sh">'</span><span class="s">year</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">DataFrame after unstacking </span><span class="sh">'</span><span class="s">year</span><span class="sh">'</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df_unstacked_year</span><span class="p">)</span>

<span class="c1"># Unstacking another level, e.g., 'city'
</span><span class="n">df_unstacked_city</span> <span class="o">=</span> <span class="n">df_indexed</span><span class="p">.</span><span class="nf">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">DataFrame after unstacking </span><span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="s">:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">df_unstacked_city</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">stack()</code> is often used to transform “wide” data (many columns) into “long” data (fewer columns, but more rows), which is often preferred for plotting with libraries like Seaborn or for certain machine learning models. <code class="language-plaintext highlighter-rouge">unstack()</code> is useful when you want to compare values across different categories laid out as columns. These operations can be a bit mind-bending at first, but mastering them gives you incredible flexibility in data manipulation.</p> <h3 id="conclusion-your-journey-to-pandas-mastery">Conclusion: Your Journey to Pandas Mastery</h3> <p>Phew! That was a lot, wasn’t it? We’ve journeyed through chaining methods for cleaner code, embraced vectorization for speed, harnessed the power of <code class="language-plaintext highlighter-rouge">groupby()</code> for aggregation, cleaned strings with <code class="language-plaintext highlighter-rouge">.str</code>, optimized memory with categorical data, navigated time with <code class="language-plaintext highlighter-rouge">.dt</code> and <code class="language-plaintext highlighter-rouge">resample()</code>, and even reshaped our data with <code class="language-plaintext highlighter-rouge">stack()</code> and <code class="language-plaintext highlighter-rouge">unstack()</code>.</p> <p>These tips aren’t just theoretical; they are the tools I use <em>daily</em> to tackle real-world data problems efficiently and elegantly. Pandas is a vast library, and there’s always more to learn. The best way to solidify these concepts is to <strong>practice, practice, practice!</strong> Grab a dataset (Kaggle is a fantastic resource!), open a Jupyter Notebook, and start applying these techniques.</p> <p>Remember, data science is an iterative process. Don’t be afraid to experiment, make mistakes, and then refactor your code. Each tip you master makes you a more confident and capable data scientist. Happy coding!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/cracking-the-ai-black-box-why-explainable-ai-xai-i/">Cracking the AI Black Box: Why Explainable AI (XAI) is Our Superpower</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/the-secret-life-of-states-how-markov-chains-predic/">The Secret Life of States: How Markov Chains Predict Our Next Move (Without Remembering the Past!)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/blog/2026/gradient-descent-unpacking-the-engine-of-machine-l/">Gradient Descent: Unpacking the Engine of Machine Learning</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Adarsh Nair. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/blog/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/blog/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/blog/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/blog/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/blog/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/blog/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/blog/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/blog/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/blog/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/blog/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/blog/assets/js/search-data.js"></script> <script src="/blog/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>